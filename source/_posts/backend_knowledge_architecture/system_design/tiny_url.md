---
title: 常见系统设计题系列-短网址系统
date: 2021-01-18 22:48:03
updated:
mathjax: true
categories:
- [系统设计]
tags: 
---

有些时候，确认需求比思考方案更加重要、更加困难。

在设计一个短网址系统时，我们需要考虑：

* 重定向方式：301 还是 302

302(临时重定向)更合适。永久重定向的话，浏览器会缓存重定向结果，造成某些依赖重定向的统计结果不准。

<!-- more -->

* 一个长URL对应一个短链接还是多个？

对应多个，对应多个更加有利于数据统计。

* 如何生成短链接？

生成步骤，如下：

1. 查重（如果需要）；
2. 生成64位的自增ID；
3. 保存url=>ID映射；
4. 生成64位整数对应的62进制字符串

* 如何获取短链接对应的长链接URL?

查找步骤，如下：

1. 将62进制数转换为对应的64位整数；
2. 查找存储（KV更佳），获取对应的长URL

* 额外要点
  
第一，限制主体的调用频率，防止ID耗尽；

第二，短链接URL的过期清理；
